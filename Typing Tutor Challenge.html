<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Tutor Challenge - Desktop Only</title>
    <style>
        body {
            min-height: 100vh;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(120deg, #1e3c72 0%, #2a5298 40%, #ff512f 100%);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .game-container {
            background: rgba(22, 23, 58, 0.95);
            padding: 32px 24px 32px 24px;
            border-radius: 20px;
            box-shadow: 0 12px 32px #1e3c72a0;
            max-width: 700px;
            width: 100%;
            position: relative;
        }
        h1.title {
            font-size: 2.3rem;
            font-weight: 700;
            text-align: center;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5, #00d2ff);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-shadow: 0 1px 10px #3a7bd599;
        }
        .subtitle {
            text-align: center;
            color: #a0c4ff;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        .lesson-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }
        .lesson-btn {
            border: none;
            padding: 9px 18px;
            font-size: 1rem;
            border-radius: 7px;
            background: #232354;
            color: #a0c4ff;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            box-shadow: 0 2px 8px #19194844;
        }
        .lesson-btn.active {
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: #fff;
            box-shadow: 0 4px 15px #3a7bd544;
        }
        .stats-panel {
            display: flex;
            justify-content: space-between;
            background: #232354;
            border-radius: 10px;
            margin-bottom: 18px;
            padding: 12px;
            font-size: 1.05rem;
        }
        .stat {
            text-align: center;
            flex: 1;
        }
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 4px;
            display: block;
            color: #4ade80;
            text-shadow: 0 0 6px #4ade8044;
        }
        .stat-label {
            font-size: 0.9rem;
            color: #a0c4ff;
        }
        .challenge-text {
            text-align: center;
            font-size: 1.45rem;
            margin-bottom: 12px;
            letter-spacing: 1.3px;
            min-height: 2.3em;
            user-select: none;
        }
        .char {
            display: inline-block;
            padding: 0 2px;
            transition: all 0.18s;
        }
        .char.correct {
            color: #4ade80;
            background: none;
            text-shadow: 0 0 7px #4ade8044;
        }
        .char.incorrect {
            color: #f87171;
            background: none;
            text-decoration: underline wavy #f87171;
            text-shadow: 0 0 7px #f8717144;
        }
        .char.current {
            background: linear-gradient(90deg, #3a7bd5 50%, #00d2ff 100%);
            color: #fff;
            border-radius: 4px;
            box-shadow: 0 0 8px #3a7bd588;
        }
        .input-area {
            text-align: center;
            margin-bottom: 14px;
        }
        .challenge-input {
            width: 320px;
            padding: 12px;
            font-size: 1.2rem;
            background: #232354;
            border: 2px solid #3a7bd5;
            border-radius: 8px;
            color: #fff;
            outline: none;
            margin-bottom: 7px;
        }
        .challenge-input:focus {
            box-shadow: 0 0 10px #3a7bd566;
        }
        .controls {
            text-align: center;
            margin-bottom: 12px;
        }
        .btn {
            padding: 10px 24px;
            font-size: 1rem;
            border-radius: 7px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            margin: 0 8px;
            transition: background 0.2s, color 0.2s;
        }
        .btn-primary {
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: #fff;
        }
        .btn-primary:hover {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
        }
        .btn-secondary {
            background: #232354;
            color: #a0c4ff;
        }
        .btn-secondary:hover {
            background: #2d2d68;
            color: #fff;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #232354;
            border-radius: 5px;
            margin-bottom: 18px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            width: 0%;
            transition: width 0.4s;
        }
        .virtual-keyboard {
            width: 600px;
            margin: 0 auto 16px auto;
            background: #232354;
            border-radius: 13px;
            padding: 15px 4px;
            box-shadow: 0 6px 18px #23235477;
        }
        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
        }
        .key {
            width: 38px;
            height: 38px;
            background: linear-gradient(145deg, #2a2a4a, #1a1a3a);
            border: 1px solid #3a7bd580;
            border-radius: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 3px;
            font-size: 1.05rem;
            font-weight: 600;
            color: #e0e0ff;
            position: relative;
            box-shadow: 0 2px 8px #19194844;
            transition: all 0.1s;
            user-select: none;
        }
        .key.active, .key.highlight {
            background: linear-gradient(145deg, #3a7bd5, #00d2ff);
            color: #fff;
            box-shadow: 0 4px 12px #3a7bd544;
            z-index: 3;
        }
        .key.space {
            width: 160px;
        }
        .result-popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #232354ee;
            border-radius: 16px;
            padding: 28px 18px;
            box-shadow: 0 12px 28px #1e3c72a0;
            text-align: center;
            z-index: 100;
            display: none;
            border: 1px solid #3a7bd580;
            max-width: 400px;
            width: 95%;
        }
        .result-popup.show {
            display: block;
            animation: fadeIn 0.45s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8);}
            to { opacity: 1; transform: translate(-50%, -50%) scale(1);}
        }
        .result-title {
            font-size: 1.5rem;
            color: #00d2ff;
            margin-bottom: 15px;
        }
        .result-stats {
            font-size: 1.08rem;
            margin-bottom: 20px;
            color: #e0e0ff;
            text-align: left;
        }
        .result-stats p {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
        }
        .result-stats span {
            font-weight: bold;
            color: #a0c4ff;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">Typing Tutor Challenge</h1>
        <div class="subtitle">Master the keyboard with guided lessons</div>
        <div class="lesson-selector">
            <button class="lesson-btn active" data-lesson="home-row">Home Row</button>
            <button class="lesson-btn" data-lesson="top-row">Top Row</button>
            <button class="lesson-btn" data-lesson="bottom-row">Bottom Row</button>
            <button class="lesson-btn" data-lesson="numbers">Numbers</button>
            <button class="lesson-btn" data-lesson="sentences">Sentences</button>
        </div>
        <div class="stats-panel">
            <div class="stat">
                <span class="stat-value" id="wpm">0</span>
                <span class="stat-label">WPM</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="accuracy">100%</span>
                <span class="stat-label">Accuracy</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="time">0:00</span>
                <span class="stat-label">Time</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="errors">0</span>
                <span class="stat-label">Errors</span>
            </div>
        </div>
        <div class="challenge-text" id="challenge-text">
            Click "Start Lesson" to begin your typing practice
        </div>
        <div class="progress-bar">
            <div class="progress" id="progress-bar"></div>
        </div>
        <div class="input-area">
            <input type="text" class="challenge-input" id="challenge-input" placeholder="Type here..." autocomplete="off" disabled>
        </div>
        <div class="controls">
            <button class="btn btn-primary" id="start-btn">Start Lesson</button>
            <button class="btn btn-secondary" id="reset-btn">Reset</button>
        </div>
        <div class="virtual-keyboard" id="virtual-keyboard"></div>
        <div class="result-popup" id="result-popup">
            <div class="result-title">Lesson Complete!</div>
            <div class="result-stats">
                <p>Time: <span id="result-time">0:00</span></p>
                <p>WPM: <span id="result-wpm">0</span></p>
                <p>Accuracy: <span id="result-accuracy">0%</span></p>
                <p>Errors: <span id="result-errors">0</span></p>
            </div>
            <button class="btn btn-primary" id="close-result">Continue</button>
        </div>
    </div>
    <script>
        // Lessons data
        const lessons = {
            "home-row": "asdf jkl; asdf jkl; asdf jkl; asdf jkl;",
            "top-row": "qwerty uiop qwerty uiop qwerty uiop",
            "bottom-row": "zxcvbnm zxcvbnm zxcvbnm",
            "numbers": "1234567890 1234567890 1234567890",
            "sentences": "The quick brown fox jumps over the lazy dog. Programming is fun and challenging. Practice makes perfect."
        };
        // Keyboard layout
        const keyboardLayout = [
            ['q','w','e','r','t','y','u','i','o','p'],
            ['a','s','d','f','g','h','j','k','l',';'],
            ['z','x','c','v','b','n','m'],
            [' ']
        ];
        // DOM elements
        const challengeText = document.getElementById('challenge-text');
        const challengeInput = document.getElementById('challenge-input');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const resultPopup = document.getElementById('result-popup');
        const closeResultBtn = document.getElementById('close-result');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const timeDisplay = document.getElementById('time');
        const errorsDisplay = document.getElementById('errors');
        const resultTime = document.getElementById('result-time');
        const resultWpm = document.getElementById('result-wpm');
        const resultAccuracy = document.getElementById('result-accuracy');
        const resultErrors = document.getElementById('result-errors');
        const lessonBtns = document.querySelectorAll('.lesson-btn');
        const progressBar = document.getElementById('progress-bar');
        const virtualKeyboard = document.getElementById('virtual-keyboard');
        // Game state
        let currentLesson = "home-row";
        let lessonText = "";
        let currentCharIndex = 0;
        let errors = 0;
        let correctChars = 0;
        let totalChars = 0;
        let startTime = null;
        let timerInterval = null;
        let gameActive = false;
        // Render keyboard
        function renderKeyboard() {
            virtualKeyboard.innerHTML = '';
            keyboardLayout.forEach((row, idx) => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'keyboard-row';
                row.forEach(k => {
                    const keyDiv = document.createElement('div');
                    keyDiv.className = 'key' + (k === ' ' ? ' space' : '');
                    keyDiv.textContent = k === ' ' ? 'SPACE' : k.toUpperCase();
                    keyDiv.setAttribute('data-key', k);
                    rowDiv.appendChild(keyDiv);
                });
                virtualKeyboard.appendChild(rowDiv);
            });
        }
        renderKeyboard();
        // Display lesson text with spans
        function displayText(text) {
            challengeText.innerHTML = '';
            for (let i = 0; i < text.length; i++) {
                const charSpan = document.createElement('span');
                charSpan.className = 'char';
                charSpan.textContent = text[i] === ' ' ? '·' : text[i];
                charSpan.dataset.index = i;
                challengeText.appendChild(charSpan);
            }
            updateCurrentChar();
        }
        // Update highlight for current character
        function updateCurrentChar() {
            const chars = challengeText.querySelectorAll('.char');
            chars.forEach((char, idx) => {
                char.classList.toggle('current', idx === currentCharIndex);
            });
        }
        // Highlight next key to press
        function highlightNextKey() {
            clearKeyHighlights();
            if (currentCharIndex < lessonText.length) {
                let nextChar = lessonText[currentCharIndex].toLowerCase();
                if (nextChar === ' ') nextChar = ' ';
                const keyEl = virtualKeyboard.querySelector(`.key[data-key="${nextChar}"]`);
                if (keyEl) keyEl.classList.add('highlight');
            }
        }
        // Clear keyboard highlights
        function clearKeyHighlights() {
            virtualKeyboard.querySelectorAll('.key').forEach(key => {
                key.classList.remove('highlight', 'active');
            });
        }
        // Update progress bar
        function updateProgressBar() {
            progressBar.style.width = ((currentCharIndex/lessonText.length)*100).toFixed(1) + '%';
        }
        // Update stats
        function updateStats() {
            // WPM
            let wpm = 0;
            if (startTime && correctChars > 0) {
                const elapsedMins = (Date.now() - startTime)/1000/60;
                wpm = Math.round((correctChars/5)/elapsedMins);
            }
            wpmDisplay.textContent = wpm;
            // Accuracy
            let accuracy = totalChars > 0 ? Math.round((correctChars/totalChars)*100) : 100;
            accuracyDisplay.textContent = accuracy + "%";
            // Errors
            errorsDisplay.textContent = errors;
        }
        // Format time MM:SS
        function formatTime(sec) {
            const m = Math.floor(sec/60);
            const s = Math.floor(sec%60);
            return `${m}:${s < 10 ? '0'+s : s}`;
        }
        // Start lesson
        function startLesson() {
            if (gameActive) return;
            lessonText = lessons[currentLesson];
            currentCharIndex = 0;
            errors = 0;
            correctChars = 0;
            totalChars = 0;
            startTime = Date.now();
            challengeInput.value = '';
            challengeInput.removeAttribute('disabled');
            gameActive = true;
            displayText(lessonText);
            updateStats();
            updateProgressBar();
            highlightNextKey();
            challengeInput.focus();
            timeDisplay.textContent = "0:00";
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeDisplay.textContent = formatTime((Date.now()-startTime)/1000);
            }, 1000);
        }
        // End lesson
        function endLesson() {
            gameActive = false;
            challengeInput.setAttribute('disabled', true);
            clearInterval(timerInterval);
            const elapsedTime = (Date.now()-startTime)/1000;
            const wpm = Math.round((correctChars/5)/(elapsedTime/60));
            const accuracy = totalChars > 0 ? Math.round((correctChars/totalChars)*100) : 100;
            resultTime.textContent = formatTime(elapsedTime);
            resultWpm.textContent = wpm;
            resultAccuracy.textContent = accuracy + "%";
            resultErrors.textContent = errors;
            resultPopup.classList.add('show');
        }
        // Reset lesson
        function resetLesson() {
            gameActive = false;
            challengeInput.value = '';
            challengeInput.setAttribute('disabled', true);
            lessonText = lessons[currentLesson];
            currentCharIndex = 0;
            errors = 0;
            correctChars = 0;
            totalChars = 0;
            startTime = null;
            clearInterval(timerInterval);
            displayText(lessonText);
            updateStats();
            updateProgressBar();
            clearKeyHighlights();
        }
        // Handle lesson selection
        lessonBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                lessonBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLesson = btn.dataset.lesson;
                resetLesson();
            });
        });
        // Handle typing
        challengeInput.addEventListener('keydown', e => {
            if (!gameActive) return;
            if (e.key.length > 1 && e.key !== "Backspace") return; // Ignore non-char keys except Backspace
            let char = e.key;
            if (char === "Backspace") {
                if (currentCharIndex > 0) currentCharIndex--;
                updateCurrentChar();
                highlightNextKey();
                updateProgressBar();
                challengeInput.value = '';
                return;
            }
            if (currentCharIndex >= lessonText.length) return;
            let expected = lessonText[currentCharIndex];
            totalChars++;
            if (char === expected) {
                correctChars++;
                const charEl = challengeText.querySelector(`.char[data-index="${currentCharIndex}"]`);
                if (charEl) charEl.classList.add('correct');
                currentCharIndex++;
                updateCurrentChar();
                updateProgressBar();
                highlightNextKey();
                if (currentCharIndex >= lessonText.length) {
                    endLesson();
                }
            } else {
                errors++;
                const charEl = challengeText.querySelector(`.char[data-index="${currentCharIndex}"]`);
                if (charEl) charEl.classList.add('incorrect');
            }
            updateStats();
            challengeInput.value = '';
            // Visual keyboard feedback
            let vk = char.toLowerCase();
            if (vk === " ") vk = " ";
            const keyEl = virtualKeyboard.querySelector(`.key[data-key="${vk}"]`);
            if (keyEl) {
                keyEl.classList.add('active');
                setTimeout(()=>keyEl.classList.remove('active'), 150);
            }
        });
        // Start button
        startBtn.addEventListener('click', startLesson);
        // Reset button
        resetBtn.addEventListener('click', resetLesson);
        // Close result popup
        closeResultBtn.addEventListener('click', () => {
            resultPopup.classList.remove('show');
            resetLesson();
        });
        // Initialize
        resetLesson();
    </script>
</body>
</html>